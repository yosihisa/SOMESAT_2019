# えだまめS関数リファレンス  
### 概要  
- edamame_core.h  
    - 定数  
    - class LSM303
        - LSM303(uint8_t,uint8_t); //コンストラクタ
        - void init_a(); //加速度センサの初期化
        - void init_m(); //地磁気センサの初期化
        - void update_a(); //加速度の更新
        - void update_m(); //地磁気の更新
        - void set_offset(); //地磁気オフセットの設定
        - int16_t x,y,z; //現在の地磁気
        - int16_t x_offset=0;
        - int16_t y_offset=0;
        - int16_t z_offset=0;
        - double arg; //現在の方位
    - class GNSS //未実装  
- edamame_ex.h 
    - 定数
    - class Power
        - Power(uint8_t); //コンストラクタ
        - void update(); //電流・電圧計更新
        - void init(); //電流・電圧計初期化
        - double voltage; //現在の電圧
        - double current; //現在の電流  
    - class Motor  
        - Motor(int,int,int,int); //コンストラクタ  
        - void init(int,int); //PWM初期化
        - void speed(int ,int); //速度設定
    - class Nichrome  
        - Nichrome(int); //コンストラクタ
        - void fire(int); //ニクロム線の出力　　
---  

## edamame_core.h  
えだまめコアボードに搭載されているセンサ類との通信・制御に用いる関数・クラスが宣言されているファイルです。


## 定数  
以下のものが定義されています。  

定数名|中身|意味
---|---|---
LSM303AGR_A|0x19|LSM303AGRの加速度センサのI2Cアドレス
LSM303AGR_M|0x1E|LSM303AGRの地磁気センサのI2Cアドレス
SD_CS|4|SDカードのCSに繋がっているピン番号

## LSM303クラス
地磁気・加速度センサに関連するクラスです。  
以下のメンバ関数を呼び出すことができます。
宣言|LSM303(uint8_t address_a,uint8_t address_m)
---|---
概要|コンストラクタ
引数|address_a LSM303AGRの加速度センサのI2Cアドレス
引数|address_m LSM303AGRの地磁気センサのI2Cアドレス
解説|
<br>  

宣言|void LSM303.init_a() ※未実装
---|---
概要|加速度センサの初期化
引数|なし
戻り値|無し
解説|加速度センサを使うにはまずこの関数を呼び出して、初期化する必要があります。<br>プログラムの最初で1度だけ呼び出せば十分です。
<br>  

宣言|void LSM303.init_m()
---|---
概要|地磁気センサの初期化
引数|なし
戻り値|無し
解説|地磁気センサを使うにはまずこの関数を呼び出して、初期化する必要があります。<br>プログラムの最初で1度だけ呼び出せば十分です。
<br>  

宣言|void LSM303.update_a() ※未実装
---|---
概要|加速度センサの更新
引数|なし
戻り値|無し
解説|現在の加速度を測定し、メンバ変数を更新します。
<br>  

宣言|void LSM303.update_m()
---|---
概要|地磁気センサの更新
引数|なし
戻り値|無し
解説|現在の地磁気を測定し、メンバ変数を更新します。
<br>

宣言|void LSM303.set_offset(int16_t x, int16_t y, int16_t z)
---|---
概要|地磁気センサのオフセット値の設定
引数|なし
戻り値|無し
解説|現在の地磁気を測定し、メンバ変数を更新します。

以下のメンバ変数を呼び出すことができます。  

型|変数名|意味
---|---|---
int16_t|LSM303.x <br>LSM303.y <br> LSM303.z|現在の各軸の地磁気の値。update_mによって更新される。
double|arg|現在向いている方角。update_mによって更新される。
int16_t|x_offset=0|磁気のオフセット量の設定用　※将来的にset_offset()に統廃合予定
int16_t|y_offset=0|磁気のオフセット量の設定用　※将来的にset_offset()に統廃合予定
int16_t|z_offset=0|磁気のオフセット量の設定用　※将来的にset_offset()に統廃合予定
<br>

### GNSSクラス  
GNSS(GPS)関連のクラスです。  
まだ未実装です。    

---
# edamame_ex.h  
えだまめ拡張ボードに搭載されているセンサ類との通信・制御に用いる関数・クラスが宣言されているファイルです。


## 定数  
以下のものが定義されています。 

定数名|中身|意味
---|---|---
INA226|0x45|INA226のI2Cアドレス
MOTOR_LF|25|モーター(左・正転方向)のPWM入力ピン
MOTOR_LR|26|モーター(左・逆転方向)のPWM入力ピン
MOTOR_RF|14|モーター(右・正転方向)のPWM入力ピン
MOTOR_RR|27|モーター(右・逆転方向)のPWM入力ピン
NICHROME|13|ニクロム線の入力ピン

## Powerクラス
電流・電圧計の操作に関連するクラスです。
以下のメンバ関数を呼び出すことができます。  

宣言|Power(uint8_t address)
---|---
概要|コンストラクタ
引数|address_a INA226のI2Cアドレス
解説|
<br>  

宣言|void Power.init()
---|---
概要|電流・電圧計の初期化
引数|なし
戻り値|無し
解説|INA226を使うにはまずこの関数を呼び出して、初期化する必要があります。<br>プログラムの最初で1度だけ呼び出せば十分です。
<br>  

宣言|void Power.update()
---|---
概要|電流・電圧の更新
引数|なし
戻り値|無し
解説|現在の電流・電圧を測定し、メンバ変数を更新します。
<br>

以下のメンバ変数を呼び出すことができます。  

型|変数名|意味
---|---|---
double|voltage|現在の電圧。update_mによって更新される。
double|current|現在の電流。update_mによって更新される。

## Motorクラス
モーターの制御に関連するクラスです。  
デフォルトではESP32のPWMチャンネルのうち0～4chを使用します。  
以下のメンバ関数を呼び出すことができます。  

宣言|Motor(int ch0=0,int ch1=1,int ch2=2,int ch3=3)
---|---
概要|コンストラクタ
引数|ch_ PWMチャンネル
解説|モーターの制御に使うPWMチャンネルを指定します。<br>この引数は省略できるようにしたかった。
<br>  

宣言|void Motor.init(int hz,int bit)
---|---
概要|モーター制御用のPWMピンの初期化をします。
引数|hz PWM周波数[Hz]を指定します。<br>bit PWMのビット数を指定します。8を指定した場合は速度は0～255、10を指定した場合は0～1023の範囲で調整することができます。
戻り値|無し
解説|モーターを使うにはまずこの関数を呼び出して、初期化する必要があります。<br>プログラムの最初で1度だけ呼び出せば十分です。
<br>  

宣言|void Motor.speed(int L,int R)
---|---
概要|モーターの速度を変更します。
引数|L 左モーターの速度<br>R 右モーターの速度
戻り値|無し
解説|0を指定すると静止、正の値を指定すると正転、負の値を指定すると逆転します。<br>例えば、Motor.init()でPWMの分解能を10bitとした場合では、speed(1024,1024)とすると最大速度で前進、speed(-1024,-1024)とすると最大速度で後退します。
<br>  

## Nichromeクラス
ニクロム線の制御に関するクラスです。
以下のメンバ関数を呼び出すことができます。  

宣言|Nichrome(int ch)
---|---
概要|コンストラクタ
引数|ch PWMチャンネル
解説|ニクロム線の制御に使うPWMチャンネルを指定します。<br>この引数は省略できるようにしたかった。
<br>  

宣言|void Motor.fire(int power)
---|---
概要|ニクロム線の出力を設定します。
引数|power ニクロム線の出力（0～255）
戻り値|無し
解説|
<br>  